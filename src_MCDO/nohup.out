Using downloaded and verified file: ./data/train_32x32.mat
Using downloaded and verified file: ./data/test_32x32.mat

Starting hyperparameter search for 1 samples per class...
[I 2024-11-29 16:53:28,006] A new study created in memory with name: no-name-60ab6106-1706-4114-bc66-9ea0a752be63
/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py:107: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float instead.
  drop_out = trial.suggest_uniform('drop_out', 0.2, 0.5)
/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py:108: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('lr', 1e-4, 1e-2)
[I 2024-11-29 16:53:40,307] Trial 3 finished with value: 2.4581786751747132 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.46740911568341137, 'lr': 0.0021672841044547216, 'epochs': 79}. Best is trial 3 with value: 2.4581786751747132.
[I 2024-11-29 16:53:41,128] Trial 1 finished with value: 2.531246960917606 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.4608580981675875, 'lr': 0.00028102775017788557, 'epochs': 97}. Best is trial 3 with value: 2.4581786751747132.
[I 2024-11-29 16:53:43,162] Trial 2 finished with value: 2.4643231011644193 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 4, 'drop_out': 0.4768893650459622, 'lr': 0.007528887101032716, 'epochs': 90}. Best is trial 3 with value: 2.4581786751747132.
[I 2024-11-29 16:53:44,523] Trial 0 finished with value: 2.303393859012871 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.458235024586322, 'lr': 0.00014865281142417434, 'epochs': 85}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:53:47,437] Trial 4 finished with value: 8.442833967269605 and parameters: {'batch_size': 32, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.21451543737933665, 'lr': 0.00045415382887024387, 'epochs': 81}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:53:51,935] Trial 6 finished with value: 3.9245434403419495 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.32272419104053107, 'lr': 0.001459800636228687, 'epochs': 90}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:00,172] Trial 5 finished with value: 5.560353019569494 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.24329399867450507, 'lr': 0.0007729971489738916, 'epochs': 97}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:01,556] Trial 8 finished with value: 2.5811309120323083 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 4, 'drop_out': 0.22922202521976268, 'lr': 0.00025713057930485604, 'epochs': 81}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:06,573] Trial 10 finished with value: 2.82637524906593 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 4, 'drop_out': 0.20725988299209105, 'lr': 0.0003721344402001436, 'epochs': 61}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:08,090] Trial 9 finished with value: 2.5945055303694327 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.28734837221357823, 'lr': 0.0002194785015034318, 'epochs': 76}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:08,239] Trial 7 finished with value: 17.492545698858372 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 64, 'num_layers': 2, 'drop_out': 0.2039131227004963, 'lr': 0.0012900682057347978, 'epochs': 89}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:13,209] Trial 11 finished with value: 2.637603029420104 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.4104245468788687, 'lr': 0.00018939415755770488, 'epochs': 73}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:14,889] Trial 13 finished with value: 4.903947335481644 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.2901631257937846, 'lr': 0.0008508181665354441, 'epochs': 59}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:18,270] Trial 12 finished with value: 14.24216753319849 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.21829855655340752, 'lr': 0.0028602363708550957, 'epochs': 68}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:18,880] Trial 15 finished with value: 2.3060371398925783 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.41811127311274754, 'lr': 0.00010646863388278002, 'epochs': 65}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:21,000] Trial 16 finished with value: 2.4670189380645753 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.40999031327949886, 'lr': 0.003621550068109058, 'epochs': 62}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:21,504] Trial 14 finished with value: 2.304059470535084 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 2, 'drop_out': 0.4012606410485064, 'lr': 0.00010738002302191234, 'epochs': 58}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:21,536] Trial 17 finished with value: 3.3115621626377107 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.4186579088414653, 'lr': 0.006504646256886894, 'epochs': 69}. Best is trial 0 with value: 2.303393859012871.
[I 2024-11-29 16:54:23,546] Trial 18 finished with value: 2.3033762693405153 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.40269298054150093, 'lr': 0.00010797683973038166, 'epochs': 85}. Best is trial 18 with value: 2.3033762693405153.
[I 2024-11-29 16:54:24,186] Trial 19 finished with value: 2.3028304789476333 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.39657966493440916, 'lr': 0.00011477528061460719, 'epochs': 50}. Best is trial 19 with value: 2.3028304789476333.
Best trial for 1 samples: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.39657966493440916, 'lr': 0.00011477528061460719, 'epochs': 50}
Traceback (most recent call last):
  File "/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py", line 199, in <module>
    f.wrtie("Best parameters found:\n")
AttributeError: '_io.TextIOWrapper' object has no attribute 'wrtie'
Using downloaded and verified file: ./data/train_32x32.mat
Using downloaded and verified file: ./data/test_32x32.mat

Starting hyperparameter search for 1 samples per class...
[I 2024-11-29 16:56:26,171] A new study created in memory with name: no-name-a497de95-6f74-402d-8caa-52a233569273
/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py:107: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float instead.
  drop_out = trial.suggest_uniform('drop_out', 0.2, 0.5)
/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py:108: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('lr', 1e-4, 1e-2)
[I 2024-11-29 16:56:37,029] Trial 3 finished with value: 3.599245470762253 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.37481318813558406, 'lr': 0.0009878892777306263, 'epochs': 63}. Best is trial 3 with value: 3.599245470762253.
[I 2024-11-29 16:56:42,063] Trial 2 finished with value: 10.477949500843218 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 2, 'drop_out': 0.37757902124823917, 'lr': 0.009701201415597938, 'epochs': 94}. Best is trial 3 with value: 3.599245470762253.
[I 2024-11-29 16:56:43,780] Trial 0 finished with value: 3.3496707677841187 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.34581446205215366, 'lr': 0.000587389427353262, 'epochs': 80}. Best is trial 0 with value: 3.3496707677841187.
[I 2024-11-29 16:56:45,593] Trial 4 finished with value: 5.2687760998931115 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.3226426420227323, 'lr': 0.003361594658495118, 'epochs': 77}. Best is trial 0 with value: 3.3496707677841187.
[I 2024-11-29 16:56:46,089] Trial 5 finished with value: 2.32407009601593 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 4, 'drop_out': 0.31229661481565535, 'lr': 0.000832719415149858, 'epochs': 69}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:56:46,221] Trial 1 finished with value: 7.320149300973626 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.38400505182218725, 'lr': 0.0028074272161265727, 'epochs': 92}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:56:50,752] Trial 7 finished with value: 9.99690819978714 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.36567165743589203, 'lr': 0.002488613744915445, 'epochs': 85}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:56:58,056] Trial 9 finished with value: 4.145283722877503 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.42254928234331446, 'lr': 0.002226431647841242, 'epochs': 100}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:04,274] Trial 10 finished with value: 2.3893461589571796 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.4143549775052339, 'lr': 0.006496216281809779, 'epochs': 55}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:10,162] Trial 11 finished with value: 2.5691251362426373 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 4, 'drop_out': 0.2570362334092942, 'lr': 0.0005037556503660792, 'epochs': 93}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:10,861] Trial 8 finished with value: 2.330235719680786 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.3220956162930499, 'lr': 0.0001761590978022649, 'epochs': 77}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:13,198] Trial 6 finished with value: 2.367832200542377 and parameters: {'batch_size': 32, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.2856160688114674, 'lr': 0.00017083302696270327, 'epochs': 71}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:14,437] Trial 12 finished with value: 27.453396797180176 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.29261162078746206, 'lr': 0.0028178661991764367, 'epochs': 75}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:15,374] Trial 13 finished with value: 5.5918750882148744 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 2, 'drop_out': 0.45232692150242276, 'lr': 0.0024451584454915675, 'epochs': 60}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:27,218] Trial 16 finished with value: 4.048867642879486 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.201755513015026, 'lr': 0.00011263278819615663, 'epochs': 67}. Best is trial 5 with value: 2.32407009601593.
[I 2024-11-29 16:57:30,234] Trial 17 finished with value: 2.3039017297044584 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.4785845541293291, 'lr': 0.00015139826171439673, 'epochs': 67}. Best is trial 17 with value: 2.3039017297044584.
[I 2024-11-29 16:57:30,647] Trial 18 finished with value: 2.3046060121512113 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.2129626966554411, 'lr': 0.00010500793077383959, 'epochs': 67}. Best is trial 17 with value: 2.3039017297044584.
[I 2024-11-29 16:57:33,476] Trial 14 finished with value: 2.3042214296425985 and parameters: {'batch_size': 32, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.4914924313145334, 'lr': 0.00010616769141690477, 'epochs': 66}. Best is trial 17 with value: 2.3039017297044584.
[I 2024-11-29 16:57:34,153] Trial 15 finished with value: 2.3045898303864107 and parameters: {'batch_size': 32, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.4896749124929778, 'lr': 0.00010913108230369622, 'epochs': 65}. Best is trial 17 with value: 2.3039017297044584.
[I 2024-11-29 16:57:34,478] Trial 19 finished with value: 2.43477268158635 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.24813908093529247, 'lr': 0.0002737280871670959, 'epochs': 84}. Best is trial 17 with value: 2.3039017297044584.
Best trial for 1 samples: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.4785845541293291, 'lr': 0.00015139826171439673, 'epochs': 67}

Starting hyperparameter search for 5 samples per class...
[I 2024-11-29 16:57:34,483] A new study created in memory with name: no-name-9caa2586-7b19-4255-8504-111ec924447a
[I 2024-11-29 16:57:46,427] Trial 2 finished with value: 2.578088585334488 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 2, 'drop_out': 0.38564992378323104, 'lr': 0.0029687691507491363, 'epochs': 66}. Best is trial 2 with value: 2.578088585334488.
[I 2024-11-29 16:57:58,906] Trial 0 finished with value: 2.3028057336807253 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.37173740902382957, 'lr': 0.00010527851685554555, 'epochs': 75}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:08,368] Trial 1 finished with value: 2.85566360739213 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.367824092689659, 'lr': 0.0054715167209235666, 'epochs': 86}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:10,400] Trial 3 finished with value: 2.3049477202982844 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.4617765879044769, 'lr': 0.00045106815152871, 'epochs': 50}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:13,951] Trial 6 finished with value: 2.3096450865268707 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.41883009408848504, 'lr': 0.0019345288703129756, 'epochs': 55}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:14,921] Trial 4 finished with value: 2.7830073134914324 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.3086193937131829, 'lr': 0.001580292637566537, 'epochs': 93}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:28,180] Trial 5 finished with value: 2.3147993421858284 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.4531458599336967, 'lr': 0.004285150085482747, 'epochs': 87}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:29,224] Trial 7 finished with value: 2.464061356798003 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.3727320046193789, 'lr': 0.004871439466488557, 'epochs': 89}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:37,850] Trial 10 finished with value: 2.3031048231487032 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.4250778245514226, 'lr': 0.00021126954702287864, 'epochs': 58}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:56,092] Trial 8 finished with value: 2.304691845178604 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.49847876945339764, 'lr': 0.00018319880073321834, 'epochs': 100}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:58:56,202] Trial 9 finished with value: 2.7511108219623566 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 3, 'drop_out': 0.2781665663045951, 'lr': 0.0010736089555495574, 'epochs': 92}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:02,550] Trial 12 finished with value: 2.3124312818050385 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.40555505081336596, 'lr': 0.0003587844105825716, 'epochs': 94}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:02,628] Trial 13 finished with value: 2.5663044120692 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.3711705448531212, 'lr': 0.002325656711410299, 'epochs': 68}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:04,848] Trial 11 finished with value: 2.3029005885124207 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.38522486330046535, 'lr': 0.0001611533919720733, 'epochs': 90}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:14,266] Trial 14 finished with value: 2.406937849521637 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.22395484694324708, 'lr': 0.00010968010329325296, 'epochs': 76}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:20,685] Trial 15 finished with value: 2.3141842424869536 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.2047034658748698, 'lr': 0.00011668128462644607, 'epochs': 72}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:28,889] Trial 17 finished with value: 2.304290908575058 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.3113731948509306, 'lr': 0.00010390007638504134, 'epochs': 74}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:31,063] Trial 16 finished with value: 2.3262701668316805 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.2180662309981761, 'lr': 0.00014698412706519177, 'epochs': 73}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:31,464] Trial 18 finished with value: 2.3186770379543304 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.20016070917336892, 'lr': 0.00011827293963075119, 'epochs': 77}. Best is trial 0 with value: 2.3028057336807253.
[I 2024-11-29 16:59:34,887] Trial 19 finished with value: 2.3026810944080354 and parameters: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.3226229184566036, 'lr': 0.00010999461611456229, 'epochs': 78}. Best is trial 19 with value: 2.3026810944080354.
Best trial for 5 samples: {'batch_size': 128, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.3226229184566036, 'lr': 0.00010999461611456229, 'epochs': 78}

Starting hyperparameter search for 10 samples per class...
[I 2024-11-29 16:59:34,889] A new study created in memory with name: no-name-703efa2e-f205-4393-8901-f64aeefad64b
[I 2024-11-29 16:59:59,318] Trial 4 finished with value: 2.3087585985660555 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.4205213005724667, 'lr': 0.0006688437927797586, 'epochs': 76}. Best is trial 4 with value: 2.3087585985660555.
[I 2024-11-29 17:00:05,157] Trial 3 finished with value: 2.3086199730257446 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.4950440723048082, 'lr': 0.00018774541238522808, 'epochs': 73}. Best is trial 3 with value: 2.3086199730257446.
[I 2024-11-29 17:00:08,932] Trial 0 finished with value: 2.308431679010391 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.2254447933051026, 'lr': 0.00014746261849967311, 'epochs': 64}. Best is trial 0 with value: 2.308431679010391.
[I 2024-11-29 17:00:16,382] Trial 2 finished with value: 2.30827213396692 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.38658457240628114, 'lr': 0.006184755709250556, 'epochs': 81}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:00:22,560] Trial 5 finished with value: 2.4391656344449975 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.2187575862578226, 'lr': 0.0018955341875432161, 'epochs': 51}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:00:48,758] Trial 6 finished with value: 2.6796566903591157 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 2, 'drop_out': 0.2356009039855453, 'lr': 0.00029649901818244235, 'epochs': 87}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:00:50,949] Trial 7 finished with value: 2.327723443508148 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.37152920738988177, 'lr': 0.002480877059280918, 'epochs': 88}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:00,197] Trial 9 finished with value: 2.7328672826290132 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.3115026443493924, 'lr': 0.0009062673233388795, 'epochs': 95}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:01,173] Trial 8 finished with value: 2.345726227760315 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.48737391147769965, 'lr': 0.004101406016652835, 'epochs': 87}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:06,375] Trial 1 finished with value: 2.3113553373119498 and parameters: {'batch_size': 64, 'num_neurons': 128, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.3035305052739791, 'lr': 0.0003665303020380749, 'epochs': 93}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:21,124] Trial 12 finished with value: 2.3228075087070463 and parameters: {'batch_size': 128, 'num_neurons': 256, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.49480103280306276, 'lr': 0.0019036275249374956, 'epochs': 65}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:25,962] Trial 11 finished with value: 2.310374155166043 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.32038868639384155, 'lr': 0.00034681467816542863, 'epochs': 67}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:30,977] Trial 14 finished with value: 2.3454757313819448 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 2, 'drop_out': 0.40693573678322176, 'lr': 0.009537502357593439, 'epochs': 75}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:01:44,703] Trial 13 finished with value: 2.401158212106439 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 3, 'drop_out': 0.24389754126411706, 'lr': 0.0004888183467521179, 'epochs': 92}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:02:12,599] Trial 15 finished with value: 2.31590475853841 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.38974019054039677, 'lr': 0.006376544592114018, 'epochs': 60}. Best is trial 2 with value: 2.30827213396692.
[I 2024-11-29 17:02:17,574] Trial 16 finished with value: 2.303862826839374 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.3880451761479395, 'lr': 0.007063418883344222, 'epochs': 55}. Best is trial 16 with value: 2.303862826839374.
[I 2024-11-29 17:02:17,932] Trial 10 finished with value: 2.3027950932707966 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.28965012336117485, 'lr': 0.009676006170981157, 'epochs': 97}. Best is trial 10 with value: 2.3027950932707966.
[I 2024-11-29 17:02:19,935] Trial 17 finished with value: 2.3056058914038786 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.27729979449689773, 'lr': 0.00010438492504188776, 'epochs': 56}. Best is trial 10 with value: 2.3027950932707966.
[I 2024-11-29 17:02:24,584] Trial 18 finished with value: 2.307902975446859 and parameters: {'batch_size': 32, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.2702673359028297, 'lr': 0.00012091057286864328, 'epochs': 57}. Best is trial 10 with value: 2.3027950932707966.
[I 2024-11-29 17:02:37,770] Trial 19 finished with value: 2.3076039529909753 and parameters: {'batch_size': 32, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.2725942196730869, 'lr': 0.00012880564014529445, 'epochs': 81}. Best is trial 10 with value: 2.3027950932707966.
Best trial for 10 samples: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 4, 'drop_out': 0.28965012336117485, 'lr': 0.009676006170981157, 'epochs': 97}

Starting hyperparameter search for 50 samples per class...
[I 2024-11-29 17:02:37,773] A new study created in memory with name: no-name-ee1e4662-d5f5-4f98-ae4e-c09036eb245d
[I 2024-11-29 17:03:41,511] Trial 3 finished with value: 2.302580588980566 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 2, 'drop_out': 0.306375743436759, 'lr': 0.004682212963088405, 'epochs': 51}. Best is trial 3 with value: 2.302580588980566.
[I 2024-11-29 17:04:42,226] Trial 4 finished with value: 1.7864634335041045 and parameters: {'batch_size': 128, 'num_neurons': 64, 'conv_neurons': 64, 'num_layers': 2, 'drop_out': 0.23855312625736877, 'lr': 0.00040262581635415896, 'epochs': 63}. Best is trial 4 with value: 1.7864634335041045.
[I 2024-11-29 17:05:24,103] Trial 1 finished with value: 2.20353008987038 and parameters: {'batch_size': 32, 'num_neurons': 128, 'conv_neurons': 32, 'num_layers': 2, 'drop_out': 0.3942603604515921, 'lr': 0.00010749601487966949, 'epochs': 76}. Best is trial 4 with value: 1.7864634335041045.
[I 2024-11-29 17:05:44,561] Trial 2 finished with value: 2.3026581112342543 and parameters: {'batch_size': 64, 'num_neurons': 64, 'conv_neurons': 32, 'num_layers': 4, 'drop_out': 0.27165130457848635, 'lr': 0.005812334434832251, 'epochs': 75}. Best is trial 4 with value: 1.7864634335041045.
[I 2024-11-29 17:05:55,490] Trial 5 finished with value: 2.118914302391342 and parameters: {'batch_size': 64, 'num_neurons': 256, 'conv_neurons': 64, 'num_layers': 2, 'drop_out': 0.4459954288472598, 'lr': 0.0002675625367873687, 'epochs': 56}. Best is trial 4 with value: 1.7864634335041045.
[I 2024-11-29 17:05:56,229] Trial 0 finished with value: 1.9112850617451274 and parameters: {'batch_size': 32, 'num_neurons': 256, 'conv_neurons': 16, 'num_layers': 3, 'drop_out': 0.30527698670814885, 'lr': 0.0002916738110147028, 'epochs': 89}. Best is trial 4 with value: 1.7864634335041045.
Using downloaded and verified file: ./data/train_32x32.mat
Using downloaded and verified file: ./data/test_32x32.mat

Starting hyperparameter search for 4000 samples per class...
[I 2024-11-29 17:08:04,582] A new study created in memory with name: no-name-3581ee90-606d-4504-bcaf-b84848651962
/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py:107: FutureWarning: suggest_uniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float instead.
  drop_out = trial.suggest_uniform('drop_out', 0.2, 0.5)
/Users/samirgupta/Desktop/WORK/AGRIMA_WORK/Agrima_AML_final_project/src/04_hp_search_MCDO_SVHN_sample_changing.py:108: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  learning_rate = trial.suggest_loguniform('lr', 1e-4, 1e-2)
